kubernetes:
  base:
    sourceRepo:
      name: blockscout
      org: cloudwalk
    monoRepo:
      url: git@github.com:cloudwalk/monorepo-gitops.git
      appsFolder: apps-config
      argoCDValues: helms/argocd/values.yaml
    containerRegistry:
      url: gcr.io/infinitepay-mainnet
    deployConfig:
      cluster: infinitepay-mainnet
      environment: production
      steps:
      - build
      - push
      - versioning
      - deploy
      service:
        asmRevision: asm-managed
  apps:
  - name: blockscout
    secretsManager:
      enabled: true
      provider: gcpsm
    imageRepoName: blockscout
    kind: deployment
    replicas: 1
    # hpa:
    #   antiAffinity:
    #     type: required
    #     conditions:
    #       - key: app
    #         value: blockscout
    #   maxReplicas: 5
    #   minReplicas: 1
    #   targetCPUUtilizationPercentage: 50
    envs:
    - name: ETHEREUM_JSONRPC_WS_URL
      value: ws://35.215.217.3:9945
    - name: ETHEREUM_JSONRPC_HTTP_URL
      value: http://35.215.217.3:9933
    - name: ETHEREUM_JSONRPC_VARIANT
      value: geth
    - name: PORT
      value: "4000"
    - name: NETWORK
      value: "CloudWalk"
    - name: SUBNETWORK
      value: "Mainnet"
    - name: SUPPORTED_CHAINS
      value: '[ { "title": "CloudWalk Testnet", "url": "https://explorer.mainnet.cloudwalk.io/", "test_net?": true } ]'
    resources:
      limits:
        cpu: 1000m
        memory: 4Gi
      requests:
        cpu: 1000m
        memory: 3Gi
    service:
      istio: false
      healthcheck:
        initialDelaySeconds: 240
        interval: 10
        path: /
        port: 4000
        timeoutSeconds: 15
      ports:
        - containerPort: 4000
          name: app
          virtualservice:
            xFrameOptions: SAMEORIGIN
            gateway: default
            hosts:
              - blockscout.services.mainnet.cloudwalk.io
              - explorer.mainnet.cloudwalk.io
